<html><head><meta name="qrichtext" content="1" /></head><body style="font-size:9pt;font-family:MS Shell Dlg">
<p><span style="font-family:Courier">$start_titleNumérisation d'image sans interface$end_title{{\</span></p>
<p></p>
<p><span style="font-family:Courier">{{REM=                     NUMERISATION AVEC scanimage (nécessite aussi ImageMagick)                 }}\<br />{{REM=                                      testé sous Linux                                         }}\<br />{{REM=-------------------- cette commande est spécifique à chaque scanner ---------------------------}}\<br />{{REM=                     pour connaître les paramètres de votre scanner tapez dans une console     }}\<br />{{REM=                     </span><span style="font-family:Courier;font-weight:600;color:#550000">scanimage -f%d'|'</span><span style="font-family:Courier"> cela affichera séparés par | les noms des scanners      }}\<br />{{REM=                                exp :     </span><span style="font-family:Courier;color:#0000ff">brother3:net1;dev0|epkowa:libusb:001:007|</span><span style="font-family:Courier">            }}\<br />{{REM=                     récuperer la partie du nom de votre scanner située avant les deux points  }}\<br />{{REM=                                exp :     epkowa       ou    brother3                          }}\<br />{{REM=                     tapez dans une console,                                                   }}\<br />{{REM=                                </span><span style="font-family:Courier;font-weight:600;color:#550000">scanimage --help -d epkowa</span><span style="font-family:Courier">                   ou                }}\<br />{{REM=                                </span><span style="font-family:Courier;font-weight:600;color:#550000">scanimage --help -d brother3</span><span style="font-family:Courier">                                   }}\<br />{{REM=                     cela listera les commandes possibles et acceptées par votre scanner       }}\<br />{{REM=                                 exemple (tronqué) : pour     epkowa                           }}\<br />{{REM=             </span><span style="font-family:Courier;color:#0000ff">Options specific to device `epkowa':  </span><span style="font-family:Courier">                                            }}\</span></p>
<p><span style="font-family:Courier">{{REM=             </span><span style="font-family:Courier;color:#0000ff">Scan Mode: </span><span style="font-family:Courier">                                                                       }}\</span></p>
<p><span style="font-family:Courier">{{REM=                </span><span style="font-family:Courier;color:#0000ff">--mode Binary|Gray|Color [Binary] </span><span style="font-family:Courier">                                             }}\</span></p>
<p><span style="font-family:Courier">{{REM=                    </span><span style="font-family:Courier;color:#0000ff">Selects the scan mode (e.g., lineart, monochrome, or color).</span><span style="font-family:Courier">               }}\</span></p>
<p><span style="font-family:Courier">{{REM=                </span><span style="font-family:Courier;color:#0000ff">--depth 8|16 [inactive] </span><span style="font-family:Courier">                                                       }}\</span></p>
<p><span style="font-family:Courier">{{REM=                    </span><span style="font-family:Courier;color:#0000ff">Number of bits per sample, typical values are 1 for &quot;line-art&quot; and 8</span><span style="font-family:Courier">       }}\</span></p>
<p><span style="font-family:Courier">{{REM=                    </span><span style="font-family:Courier;color:#0000ff">for multibit scans.</span><span style="font-family:Courier">                                                        }}\<br />{{REM=                </span><span style="font-family:Courier;color:#0000ff">--resolution 50..3200dpi [300]                                                </span><span style="font-family:Courier"> }}\</span></p>
<p><span style="font-family:Courier">{{REM=                    </span><span style="font-family:Courier;color:#0000ff">Sets the resolution of the scanned image.                                  </span><span style="font-family:Courier">}}\</span></p>
<p><span style="font-family:Courier">{{REM=                                                                                               }}\</span></p>
<p><span style="font-family:Courier">{{REM=     nous voyons que l'option --</span><span style="font-family:Courier;color:#0000ff">mode</span><span style="font-family:Courier"> peut comporter trois valeurs : </span><span style="font-family:Courier;color:#0000ff">Binary|Gray|Color</span><span style="font-family:Courier">          }}\<br />{{REM=     nous voyons que l'option --</span><span style="font-family:Courier;color:#0000ff">depth</span><span style="font-family:Courier"> peut comporter deux valeurs : </span><span style="font-family:Courier;color:#0000ff">8|16</span><span style="font-family:Courier">                       }}\<br />{{REM=     nous voyons que l'option --</span><span style="font-family:Courier;color:#0000ff">resolution</span><span style="font-family:Courier"> peut comporter plusieurs valeurs de :</span><span style="font-family:Courier;color:#0000ff">50..3200 dpi</span><span style="font-family:Courier">   }}\<br />{{REM=                                                                                               }}\</span></p>
<p><span style="font-family:Courier">{{REM=     nous bâtissons la ligne de commande du scanner en modifiant quelques options possibles    }}\<br /></span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(scanCommande  ,--mode=Color --resolution=72 )}}\<br /></span></p>
<p><span style="font-family:Courier">{{REM=-------------------- on part a priori sur un seul scanner trouvé ----------------------------}}\</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(scanDev_0,)}}\</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(scanDev_1,)}}\</span></p>
<p></p>
<p><span style="font-family:Courier">{{REM=-------------------- définition des fichiers temporaires ------------------------------------}}\</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(ListScanDevFile,{{AP=../../tmp/devicelist.txt}})}}\</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(LastScannedFile,{{AP=../../tmp/lastscanned}})}}\</span></p>
<p></p>
<p><span style="font-family:Courier">{{REM=-------------------- récuperer la liste des scanners ----------------------------------------}}\</span></p>
<p><span style="font-family:Courier">{{:: exe_process (WaitEnd,../../Plug/scanimage/listdevice.sh,{{VAR=ListScanDevFile}})}}\</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(ListScanDevData,$File{{VAR=ListScanDevFile}})}}\                        {{REM=      on charge dans 'ListScanDevData' le fichier de la liste des scanners }}</span></p>
<p></p>
<p><span style="font-family:Courier">{{REM=-------------------- positionner les actions selon les scanners trouvés----------------------}}\</span></p>
<p><span style="font-family:Courier">{{:: VAR_SPLIT(scanDev_,{{VAR=ListScanDevData}},-+-,FALSE) }}\                       {{REM=      on explose 'ListScanDevData' en plusieurs variables 'scanDev_0' 'scanDev_1' ... 'scanDev_n' }} </span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(annulerTout  ,{{:: TEST(S,{{VAR=scanDev_0}},=,,NOP,)}})}}\              {{REM=      si pas de scanner trouve en premiere position 'annulerTout' prend la valeur NOP}}</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(doChoixListe ,{{:: TEST(S,{{VAR=scanDev_1}},=,,NOP,DO_LISTE)}})}}\      {{REM=      test si plus d'un scanner alors afficher la liste de choix}}</span></p>
<p></p>
<p><span style="font-family:Courier">{{REM=-------------------- selection du scanner----------------------------------------------------}}\</span></p>
<p><span style="font-family:Courier">{{REM=                     si un seul on ne présente pas la liste de choix on le prend             }}\</span></p>
<p></p>
<p><span style="font-family:Courier">{{REM=           On actionne l'affichage de la liste dans le cas ou doChoixListe=DO_LISTE          }}\</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(resultatSelectLst     ,{{:: {{VAR=doChoixListe}}({{VAR=ListScanDevData}},Liste des scanners,-+-,listConfirmation)}})}}\</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(resultatSelectDev     ,{{:: SI(S,{{VAR=scanDev_1}},=,,{{VAR=scanDev_0}},{{:: SI(S,{{VAR=listConfirmation}},=,Accepted,{{VAR=resultatSelectLst}},)}})}})}}\</span></p>
<p></p>
<p><span style="font-family:Courier">{{::#SET_VAR(toPrefix     ,{{::#SI(S,{{VAR=resultatSelectDev}},=,,,&lt;p&gt;&lt;br&gt;)}})}}\            {{REM=      si sélection du scanner vide mettre le prefix à vide }}</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(doScanner    ,{{:: SI(S,{{VAR=resultatSelectDev}},=,,NOP,EXE_PROCESS)}})}}\     {{REM=      si sélection du scanner vide ne pas lancer le process }}</span></p>
<p><span style="font-family:Courier">{{:: SET_VAR(doInsert     ,{{:: SI(S,{{VAR=resultatSelectDev}},=,,NOP,INSERT_IMAGE)}})}}\    {{REM=      si sélection du scanner vide ne pas inserer l'image }}</span></p>
<p></p>
<p><span style="font-family:Courier">{{REM=-------------------- on actionne le scanner et l'insertion -------------------------------}}\<br />{{:: {{VAR=annulerTout}}{{VAR=doScanner}}(WaitEnd,../../Plug/scanimage/scan.sh,{{VAR=resultatSelectDev}},{{VAR=scanCommande}},{{VAR=LastScannedFile}})}}\</span></p>
<p><span style="font-family:Courier">}}{{::#{{VAR=annulerTout}}VAR(toPrefix)}}{{:: {{VAR=annulerTout}}{{VAR=doInsert}}({{VAR=LastScannedFile}}.png, 700 , 700)}}</span></p>
</body></html>
